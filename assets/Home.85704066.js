import{d as $,s as p,a as h,r as f,o as i,c as d,b as t,w as x,v as _,u as n,e as F,f as k,g as C,h as E,i as m,j as A,t as v,k as P,l as S,m as w,n as L,F as b,p as y,q as R,x as j}from"./index.dac24cdc.js";import{_ as U,t as H}from"./utils.888475b6.js";const g=$({id:"user",state:()=>({}),actions:{async handleLogin(s){try{const{error:e,user:a}=await p.auth.signIn({email:s.email,password:s.password});e&&alert("Ha ocurrido un error de acceso: "+e.message),!e&&!a&&alert("\xA1Revisa tu correo pincha en el enlace!")}catch(e){console.error("Error detectado:",e.message),alert(e.error_description||e)}},async handleSignup(s){try{const{email:e,password:a}=s;if(!e||!a){alert("Por favor introduce el correo y la contrase\xF1a.");return}const{error:o}=await p.auth.signUp({email:e,password:a});if(o){alert(o.message),console.error(o,o.message);return}alert("Registro comprobado, se enviar\xE1 un email para la activaci\xF3n")}catch(e){alert("\xA1Lo sentimos ha ocurrido un error de inicio!"),console.error("Error de singin",e)}},async handleOAuthLogin(s){const{error:e}=await p.auth.signIn({provider:s});e&&console.error("Error: ",e.message)},async handlePasswordReset(){const s=prompt("Por favor introduce tu correo:");if(!s)window.alert("Se necesita el correo electr\xF3nico.");else{const{error:e}=await p.auth.api.resetPasswordForEmail(s);alert(e?"Error: "+e.message:"Se enviar\xE1 un correo para restablecer la contrase\xF1a.")}},async handleUpdateUser(s){try{const{error:e}=await p.auth.update(s);e?alert("Ha ocurrido un error al actualizar la informaci\xF3n del usuario: "+e.message):(alert("\xA1Se ha actualizado la informaci\xF3n del usuario!"),window.location.href="/")}catch(e){alert("Ha ocurrido un error actualizando la informaci\xF3n del usuario: "+e.message)}},async handleLogout(){console.log("Saliendo");try{const{error:s}=await p.auth.signOut();if(s){alert("Ha ocurrido un error al salir de la sesi\xF3n"),console.error("Error",s);return}alert("\xA1Has salido de la sesi\xF3n!")}catch(s){alert("Error desconocido al salir de la sesi\xF3n"),console.error("Error",s)}}}}),T={class:"w-full sm:w-1/2 xl:w-1/3"},V={class:"border-teal p-8 border-t-12 mb-6 rounded-lg shadow-lg bg-white"},B={class:"mb-4"},O=t("label",{class:"font-bold text-grey-darker block mb-2"},"Contrase\xF1a",-1),N={class:"flex flex-col gap-2"},z=h({__name:"PasswordReset",setup(s){const e=g(),a=f("");return(o,c)=>(i(),d("main",T,[t("div",V,[t("div",B,[O,x(t("input",{type:"password",class:"block appearance-none w-full bg-white border border-grey-light hover:border-grey px-2 py-2 rounded shadow",placeholder:"T\xFA contrase\xF1a","onUpdate:modelValue":c[0]||(c[0]=r=>a.value=r)},null,512),[[_,a.value]])]),t("div",N,[t("a",{onClick:c[1]||(c[1]=r=>n(e).handleUpdateUser({password:a.value})),href:"#",class:"btn btn-accent",tabindex:"0"}," Actualizar contrase\xF1a ")])])]))}}),I={class:"w-full flex justify-center sm:w-1/2 xl:w-1/3"},q={class:"border-teal p-8 border-t-12 mb-6 rounded-lg shadow-lg bg-white"},D={class:"form-control w-full max-w-xl"},G=t("label",{class:"font-bold text-grey-darker block mb-2"},"Email",-1),M={class:"form-control bg-white w-full max-w-xl"},J=t("label",{class:"font-bold text-grey-darker block mb-2"},"Contrase\xF1a",-1),K={class:"flex flex-col gap-2"},Q={key:0},W={key:1},X={class:"mt-2 text-sm leading-5"},Y={class:"mt-4"},Z=k('<div class="relative"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-gray-300"></div></div><div class="relative flex justify-center text-sm leading-5"><span class="px-2 bg-white text-gray-500">O contin\xFAa con</span></div></div>',1),ee={class:"mt-6"},te={class:"mt-6"},se={class:"block w-full rounded-md shadow-sm"},oe={class:"mt-6"},re={class:"block w-full rounded-md shadow-sm"},ae=h({__name:"Auth",setup(s){const e=g(),a=f(""),o=f("");return(c,r)=>(i(),d("main",I,[t("div",q,[t("div",D,[G,x(t("input",{type:"text",class:"input input-bordered input-accent flex justify-center w-full max-w-xl",placeholder:"T\xFA correo","onUpdate:modelValue":r[0]||(r[0]=l=>a.value=l)},null,512),[[_,a.value]])]),t("div",M,[J,x(t("input",{type:"password",class:"input input-bordered input-accent bg-white w-full max-w-xl",placeholder:"T\xFA contrase\xF1a","onUpdate:modelValue":r[1]||(r[1]=l=>o.value=l)},null,512),[[_,o.value]])]),t("div",K,[t("a",{onClick:r[2]||(r[2]=l=>n(e).handleSignup({email:a.value,password:o.value})),href:"#",class:"btn btn-sm btn-secondary btn-wide max-w-xl mt-4",tabindex:"0"}," Reg\xEDstrate "),t("a",{onClick:r[3]||(r[3]=l=>n(e).handleLogin({email:a.value,password:o.value})),href:"#",class:"btn btn-sm btn-accent text-white btn-wide max-w-xs mt-1"},[o.value.length?(i(),d("span",Q,"Entrar")):(i(),d("span",W," Enviar enlace m\xE1gico "))])]),t("div",X,[t("a",{onClick:r[4]||(r[4]=F((...l)=>n(e).handlePasswordReset&&n(e).handlePasswordReset(...l),["prevent"])),href:"/",class:"font-medium text-indigo-600 hover:text-indigo-500 focus:outline-none focus:underline transition ease-in-out duration-150"}," \xBFOlvidaste la contrase\xF1a? ")]),t("div",Y,[Z,t("div",ee,[t("div",te,[t("span",se,[t("button",{onClick:r[5]||(r[5]=l=>n(e).handleOAuthLogin("github")),type:"button",class:"btn btn-active btn-wide max-w-xs"}," GitHub ")])]),t("div",oe,[t("span",re,[t("button",{onClick:r[6]||(r[6]=l=>n(e).handleOAuthLogin("google")),type:"button",class:"btn btn-outline btn-wide max-w-xs"}," Google ")])])])])])]))}}),ne={},le={class:"card bordered animate-pulse"},ie=k('<div class="px-8 pt-10"><div class="h-64 bg-gray-500 rounded"></div></div><div class="card-body"><div class="space-y-2"><div class="h-4 bg-gray-500 rounded"></div><div class="h-4 bg-gray-500 rounded w-5/6"></div><div class="h-4 bg-gray-500 rounded w-1/4"></div></div></div>',2),de=[ie];function ce(s,e){return i(),d("div",le,de)}var ue=U(ne,[["render",ce]]);const pe={class:"card bordered"},me={class:"px-8 pt-10"},xe=["src"],he={class:"card-body"},fe={class:"card-title"},_e={class:"justify-end card-actions"},ge=h({__name:"ProductCard",props:{product:null},setup(s){const e=C();return(a,o)=>{const c=E("router-link");return i(),d("div",pe,[t("figure",me,[t("img",{src:s.product.image,alt:"Card Image",class:"object-contain w-full h-64"},null,8,xe)]),t("div",he,[t("h2",fe,[m(c,{class:"link link-hover",to:`/product/${s.product.id}`},{default:A(()=>[P(v(s.product.title),1)]),_:1},8,["to"])]),t("p",null,v(n(H)(s.product.price)),1),t("div",_e,[t("button",{class:"btn btn-primary",onClick:o[0]||(o[0]=r=>n(e).add(s.product.id))}," A\xF1adir al carrito ")])])])}}});function ve(s,e){e||(e=window.location.href),s=s.replace(/[[]]/g,"\\$&");const o=new RegExp("[?&#]"+s+"(=([^&#]*)|&|#|$)").exec(e);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null}const we={key:0,class:"w-full h-full flex flex-col justify-center items-center p-4"},be={key:1,class:"w-full h-full flex flex-col justify-center items-center p-4"},ye={key:2,class:"p-4 max-w-7xl mx-auto"},ke={class:"grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3"},$e={class:"flex justify-center"},Ee=h({__name:"Home",setup(s){const e=S(),a=g(),o=w(()=>ve("type",location.href)==="recovery"),c=w(()=>e.list);return(r,l)=>n(o)?(i(),d("div",we,[m(z)])):n(L)===null?(i(),d("div",be,[m(ae)])):(i(),d("div",ye,[t("div",ke,[(i(),d(b,null,y(15,u=>x(m(ue,{key:u}),[[R,!n(e).loaded]])),64)),(i(!0),d(b,null,y(n(c),u=>(i(),j(ge,{key:u.id,product:u},null,8,["product"]))),128))]),t("div",$e,[t("button",{class:"input input-bordered input-accent bg-white w-full max-w-xl",onClick:l[0]||(l[0]=(...u)=>n(a).handleLogout&&n(a).handleLogout(...u))}," Salir ")])]))}});export{Ee as default};
